/*1. Determine how many books are in the Cooking category. Hands Used*/

SELECT COUNT(*)
FROM books
WHERE category = 'COOKING'

/*2. Display the number of books with a retail price of more than $30.00.*/

SELECT COUNT(*)
FROM books
WHERE retail > 30

/*3. Display the most recent publication date of all books sold by JustLee Books.*/

SELECT MAX(pubdate)
FROM books

/*4. Determine the total profit generated by sales to customer 1017. Note: Quantity should be
reflected in the total profit calculation.*/

SELECT SUM((retail-cost)*quantity)
FROM orders JOIN orderitems USING(order#) JOIN books USING(isbn)
WHERE customer# = 1017;

/*5. List the retail price of the least expensive book in the Computer category.*/

SELECT MIN(retail)
FROM books
WHERE category = 'COMPUTER'

/*6. Determine the average profit generated by orders in the ORDERS table. Note: The total
profit by order must be calculated before finding the average profit.*/

SELECT AVG(SUM((retail-cost)*quantity)) AVG_PROFIT
FROM orders JOIN orderitems USING(order#) JOIN books USING(isbn)
GROUP BY order#

/*7. Determine how many orders have been placed by each customer. Do not include in the
results any customer who hasn’t recently placed an order with JustLee Books.*/

SELECT customer#, COUNT(*)
FROM orders
GROUP BY customer#

/*8. Determine the average retail price of books by publisher name and category. Include only
the categories Children and Computer and the groups with an average retail price greater
than $50.*/

SELECT category, name, AVG (retail) "Average Retail Price"
FROM books JOIN publisher USING (pubid)
WHERE category = 'CHILDREN'
OR category = 'COMPUTER'
GROUP BY name, category
HAVING AVG (retail) > 50.00

/*9. List the customers living in Georgia or Florida who have recently placed an order totaling
more than $80.*/

SELECT DISTINCT firstname, lastname
FROM customers JOIN orders USING(customer#) JOIN orderitems USING(order#) JOIN books
USING(isbn)
WHERE (state='FL' or state='GA')
GROUP BY order#, firstname, lastname
HAVING SUM(retail*quantity)>80

/*10. What’s the retail price of the most expensive book written by Lisa White? Hands Used*/

SELECT MAX(retail)
FROM books JOIN bookauthor USING(isbn) JOIN author USING(authorid)
WHERE lname = 'WHITE'
AND fname ='LISA'